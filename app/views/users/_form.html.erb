<%= form_for @user do |f| %>
  <% if @user.errors.any? %>  
    <div id="error_explanation" class="alert alert-error">  
      <h2><%= pluralize(@user.errors.count, "error") %> prohibited this record from being saved:</h2>  
      <ul>  
      <% @user.errors.full_messages.each do |msg| %>  
        <li><%= msg %></li>  
      <% end %>  
      </ul>  
    </div>  
  <% end %>
  <fieldset>
    <%= f.label :username, :class => "control-label" do %>
    Username <br />
    <%= f.text_field :username, :disabled => !@user.id.nil? %>
    <% end -%>

    <%= f.label :email, :class => "control-label" do %>
    E-mail <br />
    <%= f.text_field :email, :disabled => !@user.id.nil? %>
    <% end -%>

	<% for role in @user.all_admin_roles %>
		<% if current_user.is?(:superuser) or current_user.is? role.to_sym %>
			<%= label_tag "user[admin_roles][#{role}]", :class => "control-label" do %>
				<%= check_box_tag "user[admin_roles][#{role}]", role, @user.admin_roles.include?(role), {:name => "user[admin_roles][]"}%>
				<%= role.humanize.titleize %>
			<% end %>
		<% end %>
	<% end %>
	<%= hidden_field_tag "user[admin_roles][]", "" %>

  </fieldset>
  <p>
    <button class="btn" type="submit">Save changes</button>
  </p>
<% end %>